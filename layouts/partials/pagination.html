{{ $use_complex_pagination := (.Site.Params.pagination.use_complex | default false) }}
{{ $use_first_and_last_item := (.Site.Params.pagination.use_first_and_last_item | default false) }}
{{ $show_disabled_items := (.Site.Params.pagination.show_disabled_items | default false) }}
{{ $paginator := .Paginator }}
{{ $index := 1 }}

{{ if or ($paginator.HasPrev) ($paginator.HasNext) }}

	<div class="pagination">

		{{if $use_first_and_last_item}}

			{{if gt $paginator.PageNumber 1 }}
				<a class="pagination__item pagination__item--first btn" href="{{ .Paginator.First.URL }}">««</a>
			{{else}}
				{{if $show_disabled_items }}
					<span class="pagination__item pagination__item--first disabled">««</span>
				{{end}}
			{{end }}
		{{end}}

		{{if $paginator.HasPrev}}
			<a class="pagination__item pagination__item--prev btn" href="{{ .Paginator.Prev.URL }}">«</a>
		{{else}}
			{{if $show_disabled_items }}
				<span class="pagination__item pagination__item--prev disabled">«</span>
			{{end }}
		{{end}}


		{{if $use_complex_pagination }}

				<span class="pagination__item pagination__item--current">
					{{- $paginator.PageNumber }}/{{ $paginator.TotalPages -}}
				</span>

		{{else }}
			<span class="pagination__item pagination__item--current">
				{{- $paginator.PageNumber }}/{{ $paginator.TotalPages -}}
			</span>
		{{end }}

		{{- if .Paginator.HasNext }}
			<a class="pagination__item pagination__item--next btn" href="{{ .Paginator.Next.URL }}">»</a>
		{{- else }}
			{{- if $show_disabled_items }}
				<span class="pagination__item pagination__item--prev disabled">»</span>
			{{- end }}
		{{- end }}

		{{- if $use_first_and_last_item  }}
			{{- if lt .Paginator.PageNumber .Paginator.TotalPages  }}
				<a class="pagination__item pagination__item--last btn" href="{{ .Paginator.Last.URL }}">»»</a>
			{{- else }}
				{{- if $show_disabled_items }}
					<span class="pagination__item pagination__item--last disabled">»»</span>
				{{- end }}
			{{- end }}
		{{- end }}
	</div>

{{ end }}


{{ $adjacent_links := 1 }}
{{ $lower_gap := add $adjacent_links 3 }}
{{ $upper_gap := sub $paginator.TotalPages (add $adjacent_links 2) }}
{{ $lower :=  (sub $paginator.PageNumber $adjacent_links) }}

{{ $upper :=  (add $paginator.PageNumber $adjacent_links) }}

{{ $min_links := (add (mul $adjacent_links 2) 3) }}

{{ if gt $paginator.TotalPages 1 }}
<div class="page-holder">
  <ul class="pagination">



    {{ range $paginator.Pagers }}

      {{ if gt $paginator.TotalPages $min_links }}

        {{ $.Scratch.Set "page_number_flag" false }}

        {{ if eq .PageNumber 1 }}
          {{ $.Scratch.Set "page_number_flag" true }}
        {{ end }}

        {{ if eq .PageNumber 2 }}
          {{ if gt $paginator.PageNumber $lower_gap }}
            <li><span>...</span></li>
          {{ else if eq $paginator.PageNumber $lower_gap }}
            {{ $.Scratch.Set "page_number_flag" true }}
          {{ end }}
        {{ end }}

        {{ if and (ge .PageNumber $lower) (le .PageNumber $upper) }}
          {{ $.Scratch.Set "page_number_flag" true }}
        {{ end }}

        {{ if eq .PageNumber (sub $paginator.TotalPages 1) }}
          {{ if lt $paginator.PageNumber $upper_gap }}
            <li><span>...</span></li>
          {{ else if eq $paginator.PageNumber $upper_gap }}
            {{ $.Scratch.Set "page_number_flag" true }}
          {{ end }}
        {{ end }}

        {{ if eq .PageNumber $paginator.TotalPages }}
          {{ $.Scratch.Set "page_number_flag" true }}
        {{ end }}

      {{ else }}

        {{ $.Scratch.Set "page_number_flag" true }}

      {{ end }}

      <!-- Output page numbers. -->
      {{ if eq ($.Scratch.Get "page_number_flag") true }}
        <li class="page-item{{ if eq . $paginator }} active{{ end }}">
          <a href="{{ .URL }}">{{ .PageNumber }}</a>
        </li>
      {{ end }}

    {{ end }}

  </ul>
</div>
{{ end }}